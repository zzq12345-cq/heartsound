<!-- Connect Page Template -->
<view class="page-container">
  <!-- Header -->
  <view class="header">
    <text class="header-title">请输入树莓派设备的IP地址</text>
    <text class="header-hint">IP地址显示在设备屏幕上</text>
  </view>

  <!-- IP Input -->
  <view class="input-section">
    <view class="input-wrapper {{inputError ? 'has-error' : ''}}">
      <input
        class="ip-input"
        type="text"
        placeholder="例如: 192.168.1.100"
        placeholder-class="input-placeholder"
        value="{{ipAddress}}"
        bindinput="onInputChange"
        bindblur="onInputBlur"
        maxlength="15"
        confirm-type="done"
        bindconfirm="onConnectTap"
      />
      <view class="clear-btn" wx:if="{{ipAddress}}" bindtap="onClearInput">
        <text class="clear-icon">✕</text>
      </view>
    </view>

    <!-- Error message -->
    <view class="error-message" wx:if="{{inputError}}">
      <text>{{inputError}}</text>
    </view>
  </view>

  <!-- Connect Button -->
  <view class="button-section">
    <button
      class="btn btn-primary btn-block connect-btn"
      bindtap="onConnectTap"
      disabled="{{connecting || !ipAddress}}"
      loading="{{connecting}}"
    >
      {{connecting ? '连接中...' : '连接设备'}}
    </button>

    <view class="divider">
      <view class="divider-line"></view>
      <text class="divider-text">或</text>
      <view class="divider-line"></view>
    </view>

    <button class="btn btn-outline btn-block" bindtap="onScanTap">
      <text class="btn-icon">📷</text>
      <text>扫码连接</text>
    </button>
  </view>

  <!-- Help Section -->
  <view class="help-section">
    <view class="help-header" bindtap="onToggleHelp">
      <text class="help-title">如何查看IP地址？</text>
      <text class="help-arrow {{showHelp ? 'expanded' : ''}}">›</text>
    </view>

    <view class="help-content {{showHelp ? 'show' : ''}}">
      <view class="help-step">
        <text class="step-number">1</text>
        <text class="step-text">确保心音智鉴设备已开机</text>
      </view>
      <view class="help-step">
        <text class="step-number">2</text>
        <text class="step-text">查看设备屏幕显示的IP地址</text>
      </view>
      <view class="help-step">
        <text class="step-number">3</text>
        <text class="step-text">确保手机和设备连接到同一WiFi网络</text>
      </view>
      <view class="help-step">
        <text class="step-number">4</text>
        <text class="step-text">在上方输入框中输入IP地址</text>
      </view>
    </view>
  </view>
</view>
