<!-- Detection Prepare Page Template -->
<view class="prepare-page">
  <!-- Header -->
  <view class="header">
    <view class="back-btn" bindtap="goBack">
      <icon-svg name="arrow-left" size="40" color="#333" />
    </view>
    <text class="title">检测准备</text>
    <view class="placeholder"></view>
  </view>

  <!-- Main content -->
  <view class="content">
    <!-- Illustration -->
    <view class="illustration-wrapper">
      <view class="heart-position-guide">
        <view class="body-outline">
          <view class="heart-marker pulse-animation">
            <icon-svg name="heart" size="48" color="#F44336" />
          </view>
          <view class="stethoscope-marker">
            <icon-svg name="stethoscope" size="64" color="#1890FF" />
          </view>
        </view>
      </view>
    </view>

    <!-- Instructions -->
    <view class="instructions">
      <view class="instruction-title">
        <text>请将听诊器放置在正确位置</text>
      </view>

      <view class="tips-carousel">
        <view class="tip-item {{index === currentTip ? 'active' : ''}}"
              wx:for="{{tips}}"
              wx:key="index">
          <text class="tip-number">{{index + 1}}</text>
          <text class="tip-text">{{item}}</text>
        </view>
      </view>

      <!-- Tip indicators -->
      <view class="tip-indicators">
        <view class="indicator {{index === currentTip ? 'active' : ''}}"
              wx:for="{{tips}}"
              wx:key="index"></view>
      </view>
    </view>

    <!-- Device status -->
    <view class="device-status {{deviceConnected ? 'connected' : 'disconnected'}}">
      <icon-svg name="{{deviceConnected ? 'check-circle' : 'warning'}}" size="32" color="{{deviceConnected ? '#4CAF50' : '#FF9800'}}" />
      <text class="status-text">{{deviceConnected ? '设备已连接' : '设备未连接'}}</text>
    </view>
  </view>

  <!-- Bottom action -->
  <view class="bottom-action">
    <button
      class="start-btn {{isReady ? '' : 'disabled'}}"
      bindtap="startDetection"
      disabled="{{!isReady}}"
    >
      <icon-svg name="target" size="40" color="#FFFFFF" />
      <text class="btn-text">开始测量</text>
    </button>

    <view class="disclaimer">
      <text>本检测仅供参考，不作为医学诊断依据</text>
    </view>
  </view>
</view>
