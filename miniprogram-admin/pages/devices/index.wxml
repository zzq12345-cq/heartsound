<!--
  Devices List Page
  设备列表页
-->
<view class="page">
  <!-- 搜索栏 -->
  <search-bar
    placeholder="搜索设备ID或IP"
    filters="{{filters}}"
    filterValue="{{statusFilter}}"
    bind:search="onSearch"
    bind:filterChange="onFilterChange"
  />

  <!-- 统计信息 -->
  <view class="stats-bar">
    <text class="stats-text">共 {{total}} 台设备</text>
  </view>

  <!-- 设备列表 -->
  <view class="device-list">
    <block wx:if="{{loading && devices.length === 0}}">
      <view class="loading-wrap">
        <view class="loading-spinner"></view>
        <text class="loading-text">加载中...</text>
      </view>
    </block>

    <block wx:elif="{{devices.length === 0}}">
      <view class="empty-wrap">
        <image class="empty-icon" src="/static/images/icon-empty.svg" mode="aspectFit" />
        <text class="empty-text">{{keyword ? '未找到相关设备' : '暂无设备'}}</text>
      </view>
    </block>

    <block wx:else>
      <device-card
        wx:for="{{devices}}"
        wx:key="id"
        device="{{item}}"
        bind:tap="onDeviceTap"
      />

      <!-- 加载更多 -->
      <view wx:if="{{loadingMore}}" class="loading-more">
        <view class="loading-spinner small"></view>
        <text>加载中...</text>
      </view>

      <view wx:elif="{{!hasMore}}" class="no-more">
        <text>没有更多了</text>
      </view>
    </block>
  </view>
</view>
